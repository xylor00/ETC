flow = [[69, 0, 0, 46, 94, 81, 64, 0, 128, 6, 97, 133], [69, 0, 0, 46, 94, 83, 64, 0, 128, 6, 97, 131], [69, 0, 0, 46, 94, 85, 64, 0, 128, 6, 97, 129], 
            [69, 0, 0, 46, 94, 87, 64, 0, 128, 6, 97, 127], [69, 0, 0, 46, 94, 90, 64, 0, 128, 6, 97, 124], [69, 0, 0, 46, 94, 92, 64, 0, 128, 6, 97, 122], 
            [69, 0, 0, 46, 94, 94, 64, 0, 128, 6, 97, 120], [69, 0, 0, 46, 94, 96, 64, 0, 128, 6, 97, 118], [69, 0, 0, 46, 94, 98, 64, 0, 128, 6, 97, 116], 
            [69, 0, 0, 46, 94, 100, 64, 0, 128, 6, 97, 114], [69, 0, 0, 46, 94, 102, 64, 0, 128, 6, 97, 112], [69, 0, 0, 46, 94, 104, 64, 0, 128, 6, 97, 110], 
            [69, 0, 0, 46, 94, 106, 64, 0, 128, 6, 97, 108], [69, 0, 0, 46, 94, 108, 64, 0, 128, 6, 97, 106], [69, 0, 0, 46, 94, 110, 64, 0, 128, 6, 97, 104], 
            [69, 0, 0, 46, 94, 112, 64, 0, 128, 6, 97, 102], [69, 0, 0, 46, 94, 114, 64, 0, 128, 6, 97, 100], [69, 0, 0, 46, 94, 116, 64, 0, 128, 6, 97, 98], 
            [69, 0, 0, 46, 94, 118, 64, 0, 128, 6, 97, 96], [69, 0, 0, 46, 94, 120, 64, 0, 128, 6, 97, 94], [69, 0, 0, 46, 94, 122, 64, 0, 128, 6, 97, 92]]

def create_ngram_model(flow, n):
    all_ngrams = []  # 存储所有IP数据包的n-gram
    
    for pkt in flow:
        # 对每个IP数据包单独处理
        pkt_ngrams = []#存储当前IP数据包的n-gram
        
        for i in range(len(pkt) - n + 1):
            ngram = pkt[i : i + n]
            pkt_ngrams.append(ngram)
        
        # 将当前IP数据包的n-gram合并到总列表    
        all_ngrams.append(pkt_ngrams)
    
    return all_ngrams


n = 2

ngram_model = create_ngram_model(flow, n)
print(ngram_model[:3])        